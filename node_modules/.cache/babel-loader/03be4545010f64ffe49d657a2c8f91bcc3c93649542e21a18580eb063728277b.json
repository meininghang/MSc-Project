{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getRedstonePrice = void 0;\nconst arweave_1 = __importDefault(require(\"arweave\"));\nconst base64url_1 = __importDefault(require(\"base64url\"));\nconst axios_1 = __importDefault(require(\"axios\"));\nconst utils_1 = __importDefault(require(\"../common/utils\"));\nclass BaseWebCurrency {\n  constructor(config) {\n    this.minConfirm = 5;\n    this.isSlow = false;\n    this.needsFee = true;\n    Object.assign(this, config);\n  }\n  // common methods\n  get address() {\n    return this._address;\n  }\n  async ready() {\n    this._address = this.wallet ? this.ownerToAddress(await this.getPublicKey()) : undefined;\n  }\n  async getId(item) {\n    return base64url_1.default.encode(Buffer.from(await arweave_1.default.crypto.hash(await item.rawSignature())));\n  }\n  async price() {\n    return getRedstonePrice(this.ticker);\n  }\n}\nexports.default = BaseWebCurrency;\nasync function getRedstonePrice(currency) {\n  const res = await axios_1.default.get(`https://api.redstone.finance/prices?symbol=${currency}&provider=redstone&limit=1`);\n  await utils_1.default.checkAndThrow(res, \"Getting price data\");\n  return res.data[0].value;\n}\nexports.getRedstonePrice = getRedstonePrice;","map":{"version":3,"names":["arweave_1","__importDefault","require","base64url_1","axios_1","utils_1","BaseWebCurrency","constructor","config","minConfirm","isSlow","needsFee","Object","assign","address","_address","ready","wallet","ownerToAddress","getPublicKey","undefined","getId","item","default","encode","Buffer","from","crypto","hash","rawSignature","price","getRedstonePrice","ticker","exports","currency","res","get","checkAndThrow","data","value"],"sources":["../../src/web/currency.ts"],"sourcesContent":[null],"mappings":";;;;;;;;;;;AAEA,MAAAA,SAAA,GAAAC,eAAA,CAAAC,OAAA;AACA,MAAAC,WAAA,GAAAF,eAAA,CAAAC,OAAA;AAGA,MAAAE,OAAA,GAAAH,eAAA,CAAAC,OAAA;AAEA,MAAAG,OAAA,GAAAJ,eAAA,CAAAC,OAAA;AAEA,MAA8BI,eAAe;EAazCC,YAAYC,MAAsB;IAJxB,KAAAC,UAAU,GAAG,CAAC;IACjB,KAAAC,MAAM,GAAG,KAAK;IACd,KAAAC,QAAQ,GAAG,IAAI;IAGlBC,MAAM,CAACC,MAAM,CAAC,IAAI,EAAEL,MAAM,CAAC;EAC/B;EAEA;EAEA,IAAIM,OAAOA,CAAA;IACP,OAAO,IAAI,CAACC,QAAQ;EACxB;EAEO,MAAMC,KAAKA,CAAA;IACd,IAAI,CAACD,QAAQ,GAAG,IAAI,CAACE,MAAM,GAAG,IAAI,CAACC,cAAc,CAAC,MAAM,IAAI,CAACC,YAAY,EAAE,CAAC,GAAGC,SAAS;EAC5F;EAEA,MAAMC,KAAKA,CAACC,IAAkB;IAC1B,OAAOnB,WAAA,CAAAoB,OAAS,CAACC,MAAM,CAACC,MAAM,CAACC,IAAI,CAAC,MAAM1B,SAAA,CAAAuB,OAAO,CAACI,MAAM,CAACC,IAAI,CAAC,MAAMN,IAAI,CAACO,YAAY,EAAE,CAAC,CAAC,CAAC;EAC9F;EACA,MAAMC,KAAKA,CAAA;IACP,OAAOC,gBAAgB,CAAC,IAAI,CAACC,MAAM,CAAC;EACxC;;AAhCJC,OAAA,CAAAV,OAAA,GAAAjB,eAAA;AA8CO,eAAeyB,gBAAgBA,CAACG,QAAgB;EACnD,MAAMC,GAAG,GAAG,MAAM/B,OAAA,CAAAmB,OAAK,CAACa,GAAG,CAAM,8CAA8CF,QAAQ,4BAA4B,CAAC;EACpH,MAAM7B,OAAA,CAAAkB,OAAK,CAACc,aAAa,CAACF,GAAG,EAAE,oBAAoB,CAAC;EACpD,OAAOA,GAAG,CAACG,IAAI,CAAC,CAAC,CAAC,CAACC,KAAK;AAC5B;AAJAN,OAAA,CAAAF,gBAAA,GAAAA,gBAAA"},"metadata":{},"sourceType":"script","externalDependencies":[]}