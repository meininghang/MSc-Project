{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { mapActions, mapGetters } from 'vuex';\nimport Storage from \"@/components/storage\";\nimport { getBundleFee, getItemMeta, genAPI } from \"arseeding-js\";\nimport Bignumber from \"bignumber.js\";\nimport fileList from \"@/components/commonComponent/list\";\nimport { reportUrl } from '@/utils/constant/apiConst';\nimport { paymentStatus } from '@/utils/constant/chainConst';\nimport uploadFile from '@/components/__dialog/uploadFileDialog';\nimport chartBanner from \"@/components/chartBanner\";\nimport commentDialog from \"@/components/__dialog/commentDialog\";\nimport { insertData } from '@/utils/encryption';\nexport default {\n  name: \"HomePage\",\n  components: {\n    Storage,\n    fileList,\n    uploadFile,\n    chartBanner,\n    commentDialog\n  },\n  data() {\n    return {\n      fileList: [],\n      instance: {},\n      pubId: undefined,\n      tableData: undefined,\n      fileInfo: undefined,\n      ShowNextStep: false,\n      balance: undefined,\n      selectedSymbol: '',\n      loading: false,\n      symbolList: [],\n      selectSymbolValue: \"ETH\",\n      totalTableLength: 0,\n      sendApi: undefined,\n      changeFileName: ''\n    };\n  },\n  computed: {\n    ...mapGetters({\n      accountStr: 'account/account',\n      allOrderList: 'order/getOrders'\n      // selectedSymbol: 'account/selectedSymbol',\n      // balance: 'account/balance',\n      // instance: 'account/instanceInfo'\n    }),\n\n    usedNumber() {\n      return Math.round(this.balance * 0.76 * 100) / 100;\n    }\n  },\n  beforeRouteLeave(to, from, next) {\n    if (to.name === 'FileDetail') {\n      this.setKeepAliveInclude(['HomePage']);\n    } else if (to.name === 'Deposit') {\n      this.setKeepAliveInclude(['HomePage']);\n    } else {\n      this.setKeepAliveInclude([]);\n    }\n    // next()\n    setTimeout(() => {\n      next();\n    }, 10);\n  },\n  async mounted() {\n    await this.getList();\n  },\n  methods: {\n    ...mapActions({\n      getAccount: 'account/getMetaMaskAccount',\n      getBalances: \"account/getAccountBalances\",\n      getOrders: 'order/getOrders',\n      searchList: 'order/searchArweave',\n      getInfo: 'account/getAccountInfo',\n      updateSelectSymbol: \"account/updateSelectSymbol\",\n      getAllSymbolPrice: \"account/getAllSymbolPrice\",\n      getFeeInfo: \"account/getFeeInfo\",\n      setKeepAliveInclude: \"keepAliveInclude/setKeepAliveInclude\"\n    }),\n    /**\r\n     * Pull the file list and calculate the storage size\r\n     * @returns {Promise<void>}\r\n     */\n    async getList() {\n      this.loading = true;\n      // await this.getAccount()\n      await this.getOrders(this.accountStr);\n      const tokenList = await this.getInfo();\n      const list = await this.getBalances(this.accountStr);\n      const totalStorage = await this.formatSymbol(tokenList, list);\n      list.sort((a, b) => {\n        return b.balance - a.balance;\n      });\n      this.selectedSymbol = list[0].symbol;\n      this.balance = list[0].balance;\n      const usedNumber = this.getUsedStorage();\n      this.$refs['storage'].getStorage(usedNumber, totalStorage);\n      this.$refs['chartMain'].inOrigin(usedNumber, totalStorage);\n      await this.getMyStorageList();\n    },\n    /**\r\n     * Gets tags for each file message(The pull list interface does not return tags and other information, need to pull again)\r\n     * @returns {Promise<void>}\r\n     */\n    async getMyStorageList() {\n      this.tableData = this.allOrderList.slice(0, 10);\n      this.totalTableLength = this.allOrderList.length;\n      this.loading = false;\n      this.$nextTick(async () => {\n        for (let i = 0; i < this.tableData.length; i++) {\n          if (this.tableData[i].paymentStatus !== paymentStatus.EXPIRED) {\n            const id = this.tableData[i].itemId;\n            this.tableData[i].metaInfo = await getItemMeta(reportUrl, id);\n            this.tableData[i] = this.formatMetaInfo(this.tableData[i]);\n          } else {\n            this.tableData[i].metaInfo = {};\n          }\n        }\n      });\n    },\n    /**\r\n     * Upload submission files, send transactions\r\n     * @param files\r\n     * @param tags\r\n     * @returns {Promise<void>}\r\n     */\n    async combineFileList(files, tags) {\n      // const selectedSymbol = this.selectedSymbol ? this.selectedSymbol : JSON.parse(sessionStorage.getItem(\"SELECT_SYMBOL_INFO\"))\n      const file = files.file;\n      const fee = await getBundleFee(reportUrl, files.file.size, this.selectedSymbol);\n      const formatedFee = new Bignumber(fee.finalFee).dividedBy(new Bignumber(10).pow(fee.decimals)).toString();\n      if (+this.balance >= +formatedFee) {\n        const reader = new FileReader();\n        reader.readAsArrayBuffer(file);\n        reader.onload = async () => {\n          // todo... Encrypt the file in this place\n          const data = reader.result;\n          const encryptionData = insertData(data, file.name);\n          console.log(233333, encryptionData);\n          const ops = {\n            tags: [{\n              name: \"FileName\",\n              value: this.changeFileName ? this.changeFileName : file.name\n            }, {\n              name: \"Content-Type\",\n              value: file.type\n            },\n            // The official version has two new fixed tags\n            {\n              name: \"APP-Name\",\n              value: \"Msc-Project\"\n            },\n            // Facilitate adot to obtain data and display increased\n            {\n              name: \"file-size\",\n              value: String(files.file.size)\n            }, ...tags]\n          };\n          if (!this.sendApi) {\n            this.sendApi = await genAPI(window.ethereum);\n          }\n          try {\n            //\n            const res = await this.sendApi.sendAndPay(reportUrl, data, this.selectedSymbol, ops);\n            this.submitResp = JSON.stringify(res);\n            this.$refs['uploadFile'].cancelUpload();\n            console.log(this.submitResp);\n          } catch (e) {\n            this.$message.error(e.message);\n            this.$refs['uploadFile'].cancelUpload();\n          }\n          await this.getOrders(this.accountStr);\n          await this.getList();\n        };\n      } else {\n        alert(`need ${formatedFee} ${this.selectedSymbol} to upload`);\n      }\n    },\n    uploadTagAndFile(tagList) {\n      this.combineFileList(this.fileInfo, tagList);\n    },\n    changeName(name) {\n      this.changeFileName = name;\n    },\n    /**\r\n     * Serialize the pulled tags information(Corresponds to the tags in the combineFileList method)\r\n     * @param item\r\n     * @returns {*&{fileName, fileType: string, tags: *[]}}\r\n     */\n    formatMetaInfo(item) {\n      let info = {\n        ...item,\n        fileName: item.id,\n        fileType: '',\n        tags: []\n      };\n      if (item.metaInfo && item.metaInfo.tags && item.metaInfo.tags.length !== 0) {\n        const list = item.metaInfo.tags.filter(item => item.name && (item.name.toUpperCase() === 'name'.toUpperCase() || item.name.toUpperCase() === 'fileName'.toUpperCase()));\n        const typeList = item.metaInfo.tags.filter(item => item.name && (item.name.toUpperCase() === 'Content-Type'.toUpperCase() || item.name.toUpperCase() === 'type'.toUpperCase()));\n        info.fileName = list && list.length !== 0 ? list[0].value : item.id;\n        info.fileType = typeList && typeList.length !== 0 ? typeList[0].value : '';\n        info.tags = item.metaInfo.tags;\n        const collectList = info.tags.filter(item => item.name.toUpperCase() === 'weave-collect'.toUpperCase());\n        item.isCollect = collectList && collectList.length !== 0;\n      }\n      return info;\n    },\n    uploadFile(fileList) {\n      this.fileInfo = fileList;\n      // this.ShowNextStep = true\n      // if (this.ShowNextStep) {\n      this.$refs['uploadFile'].openDialog(fileList);\n      // }\n    },\n\n    changeTableData(value) {\n      this.tableData = this.tableData.map(item => {\n        if (item.itemId === value.itemId) {\n          item.showButton = true;\n        } else {\n          item.showButton = false;\n        }\n        return item;\n      });\n    },\n    /**\r\n     * Page turning\r\n     * @param pageIndex\r\n     */\n    changePagination(pageIndex) {\n      this.tableData = this.allOrderList.slice((pageIndex - 1) * 10, pageIndex * 10);\n      this.$nextTick(async () => {\n        for (let i = 0; i < this.tableData.length; i++) {\n          if (this.tableData[i].paymentStatus !== paymentStatus.EXPIRED) {\n            const id = this.tableData[i].itemId;\n            this.tableData[i].metaInfo = await getItemMeta(reportUrl, id);\n            this.tableData[i] = this.formatMetaInfo(this.tableData[i]);\n          } else {\n            this.tableData[i].metaInfo = {};\n          }\n        }\n      });\n    },\n    /**\r\n     * Computing symbol\r\n     * @param tokenList\r\n     * @param balances\r\n     * @returns {Promise<number>}\r\n     */\n    async formatSymbol(tokenList, balances) {\n      const formatToken = tokenList.map(item => {\n        return {\n          tag: item.tag,\n          symbol: item.symbol\n        };\n      });\n      let list = balances.reduce((pre, cur) => {\n        let target = pre.find(ee => ee.symbol === cur.symbol);\n        if (target) {\n          Object.assign(target, cur);\n        }\n        return pre;\n      }, formatToken);\n      let symbolStr = list.map(item => item.symbol);\n      symbolStr = symbolStr.join(\",\");\n      const resultObj = await this.getAllSymbolPrice(symbolStr);\n      const resultList = Object.values(resultObj.data).map(item => {\n        return {\n          value: item.value,\n          symbol: item.symbol\n        };\n      });\n      let final = list.reduce((pre, cur) => {\n        let target = pre.find(ee => ee.symbol === cur.symbol);\n        if (target) {\n          Object.assign(target, cur);\n        } else {\n          pre.push(cur);\n        }\n        return pre;\n      }, resultList);\n      this.symbolList = final;\n      const number = final.reduce(function (total, cur) {\n        const value = cur.value ? cur.value : 0;\n        return total + Math.round(cur.balance * value * 100) / 100;\n      }, 0);\n      const feeInfo = await this.getFeeInfo('USDC');\n      // total*（10^decimals）/ finalFee\n      const decimalNumber = Math.pow(10, Number(feeInfo.data.decimals));\n      const resul = number * decimalNumber / Number(feeInfo.data.finalFee);\n      return Math.round(resul * 100) / 100;\n    },\n    getUsedStorage() {\n      const sizeList = this.allOrderList.map(item => item.size);\n      const sizeTotal = sizeList.reduce(function (total, cur) {\n        return total + cur;\n      }, 0);\n      return Math.round(sizeTotal / 1024 / 1024 * 100) / 100;\n    }\n  }\n};","map":{"version":3,"names":["mapActions","mapGetters","Storage","getBundleFee","getItemMeta","genAPI","Bignumber","fileList","reportUrl","paymentStatus","uploadFile","chartBanner","commentDialog","insertData","name","components","data","instance","pubId","undefined","tableData","fileInfo","ShowNextStep","balance","selectedSymbol","loading","symbolList","selectSymbolValue","totalTableLength","sendApi","changeFileName","computed","accountStr","allOrderList","usedNumber","Math","round","beforeRouteLeave","to","from","next","setKeepAliveInclude","setTimeout","mounted","getList","methods","getAccount","getBalances","getOrders","searchList","getInfo","updateSelectSymbol","getAllSymbolPrice","getFeeInfo","tokenList","list","totalStorage","formatSymbol","sort","a","b","symbol","getUsedStorage","$refs","getStorage","inOrigin","getMyStorageList","slice","length","$nextTick","i","EXPIRED","id","itemId","metaInfo","formatMetaInfo","combineFileList","files","tags","file","fee","size","formatedFee","finalFee","dividedBy","pow","decimals","toString","reader","FileReader","readAsArrayBuffer","onload","result","encryptionData","console","log","ops","value","type","String","window","ethereum","res","sendAndPay","submitResp","JSON","stringify","cancelUpload","e","$message","error","message","alert","uploadTagAndFile","tagList","changeName","item","info","fileName","fileType","filter","toUpperCase","typeList","collectList","isCollect","openDialog","changeTableData","map","showButton","changePagination","pageIndex","balances","formatToken","tag","reduce","pre","cur","target","find","ee","Object","assign","symbolStr","join","resultObj","resultList","values","final","push","number","total","feeInfo","decimalNumber","Number","resul","sizeList","sizeTotal"],"sources":["src/pages/workBenchPage.vue"],"sourcesContent":["<template>\r\n  <div class=\"work-bench-page__main\">\r\n    <div class=\"chart-display-show\">\r\n      <chartBanner ref=\"chartMain\"></chartBanner>\r\n    </div>\r\n    <div class=\"content-top\">\r\n      <div class=\"box-style left-storage\">\r\n        <storage ref=\"storage\" :loading=\"loading\" :usedNumber=\"usedNumber\"></storage>\r\n      </div>\r\n      <div class=\"box-style right-upload\">\r\n        <el-upload\r\n            class=\"upload-box\"\r\n            :file-list=\"fileList\"\r\n            :show-file-list=\"false\"\r\n            drag\r\n            action\r\n            :http-request=\"uploadFile\"\r\n            multiple>\r\n          <div class=\"upload-box-content\">\r\n            <i class=\"el-icon-upload upload-icon-i\" style=\"margin-right: 5px\"></i>\r\n            <p>\r\n              Drop file here, or <span style=\"color: #6447F2\">browse. </span>one file at a time.\r\n            </p>\r\n          </div>\r\n        </el-upload>\r\n      </div>\r\n    </div>\r\n    <div class=\"content-list\">\r\n      <fileList\r\n          :allOrderList=\"tableData\"\r\n          :totalTableLength=\"totalTableLength\"\r\n          :loading=\"loading\"\r\n          @changeTableData=\"changeTableData\"\r\n          @changePagination=\"changePagination\"></fileList>\r\n    </div>\r\n    <uploadFile\r\n        ref=\"uploadFile\"\r\n        @uploadTagAndFile=\"uploadTagAndFile\"\r\n        @changeName=\"changeName\"></uploadFile>\r\n    <commentDialog></commentDialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {mapActions, mapGetters} from 'vuex'\r\nimport Storage from \"@/components/storage\"\r\nimport {getBundleFee, getItemMeta, genAPI} from \"arseeding-js\"\r\nimport Bignumber from \"bignumber.js\"\r\nimport fileList from \"@/components/commonComponent/list\"\r\nimport {reportUrl} from '@/utils/constant/apiConst'\r\nimport {paymentStatus} from '@/utils/constant/chainConst'\r\nimport uploadFile from '@/components/__dialog/uploadFileDialog'\r\nimport chartBanner from \"@/components/chartBanner\"\r\nimport commentDialog from \"@/components/__dialog/commentDialog\"\r\nimport { insertData } from '@/utils/encryption'\r\n\r\nexport default {\r\n  name: \"HomePage\",\r\n  components: {\r\n    Storage,\r\n    fileList,\r\n    uploadFile,\r\n    chartBanner,\r\n    commentDialog\r\n  },\r\n  data() {\r\n    return {\r\n      fileList: [],\r\n      instance: {},\r\n      pubId: undefined,\r\n      tableData: undefined,\r\n      fileInfo: undefined,\r\n      ShowNextStep: false,\r\n      balance: undefined,\r\n      selectedSymbol: '',\r\n      loading: false,\r\n      symbolList: [],\r\n      selectSymbolValue: \"ETH\",\r\n      totalTableLength: 0,\r\n      sendApi: undefined,\r\n      changeFileName: '',\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters({\r\n      accountStr: 'account/account',\r\n      allOrderList: 'order/getOrders',\r\n      // selectedSymbol: 'account/selectedSymbol',\r\n      // balance: 'account/balance',\r\n      // instance: 'account/instanceInfo'\r\n    }),\r\n    usedNumber() {\r\n      return Math.round((this.balance * 0.76) * 100) / 100\r\n    }\r\n  },\r\n  beforeRouteLeave(to, from, next) {\r\n    if (to.name === 'FileDetail') {\r\n      this.setKeepAliveInclude(['HomePage'])\r\n    } else if (to.name === 'Deposit') {\r\n      this.setKeepAliveInclude(['HomePage'])\r\n    } else {\r\n      this.setKeepAliveInclude([])\r\n    }\r\n    // next()\r\n    setTimeout(() => {\r\n      next();\r\n    }, 10);\r\n  },\r\n  async mounted() {\r\n    await this.getList()\r\n  },\r\n  methods: {\r\n    ...mapActions({\r\n      getAccount: 'account/getMetaMaskAccount',\r\n      getBalances: \"account/getAccountBalances\",\r\n      getOrders: 'order/getOrders',\r\n      searchList: 'order/searchArweave',\r\n      getInfo: 'account/getAccountInfo',\r\n      updateSelectSymbol: \"account/updateSelectSymbol\",\r\n      getAllSymbolPrice: \"account/getAllSymbolPrice\",\r\n      getFeeInfo: \"account/getFeeInfo\",\r\n      setKeepAliveInclude: \"keepAliveInclude/setKeepAliveInclude\"\r\n    }),\r\n    /**\r\n     * Pull the file list and calculate the storage size\r\n     * @returns {Promise<void>}\r\n     */\r\n    async getList() {\r\n      this.loading = true\r\n      // await this.getAccount()\r\n      await this.getOrders(this.accountStr)\r\n      const tokenList = await this.getInfo()\r\n      const list = await this.getBalances(this.accountStr)\r\n      const totalStorage = await this.formatSymbol(tokenList, list)\r\n      list.sort((a, b) => {\r\n        return b.balance - a.balance\r\n      })\r\n      this.selectedSymbol = list[0].symbol\r\n      this.balance = list[0].balance\r\n      const usedNumber = this.getUsedStorage()\r\n      this.$refs['storage'].getStorage(usedNumber, totalStorage)\r\n      this.$refs['chartMain'].inOrigin(usedNumber, totalStorage)\r\n      await this.getMyStorageList()\r\n    },\r\n    /**\r\n     * Gets tags for each file message(The pull list interface does not return tags and other information, need to pull again)\r\n     * @returns {Promise<void>}\r\n     */\r\n    async getMyStorageList() {\r\n      this.tableData = this.allOrderList.slice(0, 10)\r\n      this.totalTableLength = this.allOrderList.length\r\n      this.loading = false\r\n      this.$nextTick(async () => {\r\n        for (let i = 0; i < this.tableData.length; i++) {\r\n          if (this.tableData[i].paymentStatus !== paymentStatus.EXPIRED) {\r\n            const id = this.tableData[i].itemId\r\n            this.tableData[i].metaInfo = await getItemMeta(reportUrl, id)\r\n            this.tableData[i] = this.formatMetaInfo(this.tableData[i])\r\n          } else {\r\n            this.tableData[i].metaInfo = {}\r\n          }\r\n        }\r\n      })\r\n    },\r\n    /**\r\n     * Upload submission files, send transactions\r\n     * @param files\r\n     * @param tags\r\n     * @returns {Promise<void>}\r\n     */\r\n    async combineFileList(files, tags) {\r\n      // const selectedSymbol = this.selectedSymbol ? this.selectedSymbol : JSON.parse(sessionStorage.getItem(\"SELECT_SYMBOL_INFO\"))\r\n      const file = files.file\r\n      const fee = await getBundleFee(reportUrl, files.file.size, this.selectedSymbol)\r\n      const formatedFee = new Bignumber(fee.finalFee).dividedBy(new Bignumber(10).pow(fee.decimals)).toString()\r\n      if (+this.balance >= +formatedFee) {\r\n        const reader = new FileReader();\r\n        reader.readAsArrayBuffer(file);\r\n        reader.onload = async () => {\r\n          // todo... Encrypt the file in this place\r\n          const data = reader.result\r\n          const encryptionData = insertData(data, file.name)\r\n          console.log(233333, encryptionData)\r\n          const ops = {\r\n            tags: [\r\n              {name: \"FileName\", value: this.changeFileName ? this.changeFileName : file.name},\r\n              {name: \"Content-Type\", value: file.type},\r\n              // The official version has two new fixed tags\r\n              {name: \"APP-Name\", value: \"Msc-Project\"},\r\n              // Facilitate adot to obtain data and display increased\r\n              {name: \"file-size\", value: String(files.file.size)},\r\n              ...tags\r\n            ]\r\n          }\r\n          if (!this.sendApi) {\r\n            this.sendApi = await genAPI(window.ethereum)\r\n          }\r\n          try {\r\n            //\r\n            const res = await this.sendApi.sendAndPay(reportUrl, data, this.selectedSymbol, ops)\r\n            this.submitResp = JSON.stringify(res)\r\n            this.$refs['uploadFile'].cancelUpload()\r\n            console.log(this.submitResp)\r\n          } catch (e) {\r\n            this.$message.error(e.message)\r\n            this.$refs['uploadFile'].cancelUpload()\r\n          }\r\n          await this.getOrders(this.accountStr)\r\n          await this.getList()\r\n        }\r\n      } else {\r\n        alert(`need ${formatedFee} ${this.selectedSymbol} to upload`)\r\n      }\r\n    },\r\n    uploadTagAndFile(tagList) {\r\n      this.combineFileList(this.fileInfo, tagList)\r\n    },\r\n    changeName(name) {\r\n      this.changeFileName = name\r\n    },\r\n    /**\r\n     * Serialize the pulled tags information(Corresponds to the tags in the combineFileList method)\r\n     * @param item\r\n     * @returns {*&{fileName, fileType: string, tags: *[]}}\r\n     */\r\n    formatMetaInfo(item) {\r\n      let info = {\r\n        ...item,\r\n        fileName: item.id,\r\n        fileType: '',\r\n        tags: []\r\n      }\r\n      if (item.metaInfo && item.metaInfo.tags && item.metaInfo.tags.length !== 0) {\r\n        const list = item.metaInfo.tags.filter(item => item.name && (item.name.toUpperCase() === 'name'.toUpperCase() || item.name.toUpperCase() === 'fileName'.toUpperCase()))\r\n        const typeList = item.metaInfo.tags.filter(item => item.name && (item.name.toUpperCase() === 'Content-Type'.toUpperCase() || item.name.toUpperCase() === 'type'.toUpperCase()))\r\n        info.fileName = list && list.length !== 0 ? list[0].value : item.id\r\n        info.fileType = typeList && typeList.length !== 0 ? typeList[0].value : ''\r\n        info.tags = item.metaInfo.tags\r\n        const collectList = info.tags.filter(item => item.name.toUpperCase() === 'weave-collect'.toUpperCase())\r\n        item.isCollect = collectList && collectList.length !== 0\r\n      }\r\n      return info\r\n    },\r\n    uploadFile(fileList) {\r\n      this.fileInfo = fileList\r\n      // this.ShowNextStep = true\r\n      // if (this.ShowNextStep) {\r\n        this.$refs['uploadFile'].openDialog(fileList)\r\n      // }\r\n    },\r\n    changeTableData(value) {\r\n      this.tableData = this.tableData.map(item => {\r\n        if (item.itemId === value.itemId) {\r\n          item.showButton = true\r\n        } else {\r\n          item.showButton = false\r\n        }\r\n        return item\r\n      })\r\n    },\r\n    /**\r\n     * Page turning\r\n     * @param pageIndex\r\n     */\r\n    changePagination(pageIndex) {\r\n      this.tableData = this.allOrderList.slice((pageIndex - 1) * 10, pageIndex * 10)\r\n      this.$nextTick(async () => {\r\n        for (let i = 0; i < this.tableData.length; i++) {\r\n          if (this.tableData[i].paymentStatus !== paymentStatus.EXPIRED) {\r\n            const id = this.tableData[i].itemId\r\n            this.tableData[i].metaInfo = await getItemMeta(reportUrl, id)\r\n            this.tableData[i] = this.formatMetaInfo(this.tableData[i])\r\n          } else {\r\n            this.tableData[i].metaInfo = {}\r\n          }\r\n        }\r\n      })\r\n    },\r\n    /**\r\n     * Computing symbol\r\n     * @param tokenList\r\n     * @param balances\r\n     * @returns {Promise<number>}\r\n     */\r\n    async formatSymbol(tokenList, balances) {\r\n      const formatToken = tokenList.map(item => {\r\n        return {\r\n          tag: item.tag,\r\n          symbol: item.symbol\r\n        }\r\n      })\r\n      let list = balances.reduce((pre, cur) => {\r\n        let target = pre.find(ee => ee.symbol === cur.symbol)\r\n        if (target) {\r\n          Object.assign(target, cur)\r\n        }\r\n        return pre\r\n      }, formatToken)\r\n      let symbolStr = list.map(item => item.symbol)\r\n      symbolStr = symbolStr.join(\",\")\r\n      const resultObj = await this.getAllSymbolPrice(symbolStr)\r\n      const resultList = Object.values(resultObj.data).map(item => {\r\n        return {\r\n          value: item.value,\r\n          symbol: item.symbol\r\n        }\r\n      })\r\n      let final = list.reduce((pre, cur) => {\r\n        let target = pre.find(ee => ee.symbol === cur.symbol)\r\n        if (target) {\r\n          Object.assign(target, cur)\r\n        } else {\r\n          pre.push(cur)\r\n        }\r\n        return pre\r\n      }, resultList)\r\n      this.symbolList = final\r\n      const number = final.reduce(function(total, cur) {\r\n        const value = cur.value ? cur.value : 0\r\n        return total + Math.round((cur.balance * value) * 100) / 100\r\n      }, 0)\r\n      const feeInfo = await this.getFeeInfo('USDC')\r\n      // total*（10^decimals）/ finalFee\r\n      const decimalNumber = (Math.pow(10, Number(feeInfo.data.decimals)))\r\n      const resul = number * decimalNumber / Number(feeInfo.data.finalFee)\r\n      return Math.round(resul * 100) / 100\r\n    },\r\n    getUsedStorage() {\r\n      const sizeList = this.allOrderList.map(item => item.size)\r\n      const sizeTotal = sizeList.reduce(function(total, cur) {\r\n        return total + cur\r\n      }, 0)\r\n      return Math.round((sizeTotal / 1024 / 1024) * 100) / 100\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.work-bench-page__main {\r\n  width: 1024px;\r\n  min-height: 90vh;\r\n  text-align: center;\r\n  margin: 0 auto;\r\n\r\n  .chart-display-show {\r\n    margin-top: 30px;\r\n  }\r\n\r\n  .content-top {\r\n    margin-top: 30px;\r\n    margin-bottom: 20px;\r\n    height: 300px;\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n\r\n    .box-style {\r\n      height: 300px;\r\n      //border: 3px solid #222326;\r\n      border-radius: 20px;\r\n      background: #f5f5f5;\r\n    }\r\n\r\n    .left-storage {\r\n      width: 600px;\r\n\r\n    }\r\n\r\n    .right-upload {\r\n      width: 400px;\r\n    }\r\n\r\n    .upload-box-content {\r\n      height: 100%;\r\n      display: flex;\r\n      justify-content: center;\r\n      align-items: center;\r\n      flex-wrap: wrap;\r\n      flex-direction: column;\r\n    }\r\n\r\n    .upload-box {\r\n      width: 100%;\r\n      height: 100%;\r\n      cursor: pointer;\r\n    }\r\n\r\n    .el-icon-upload {\r\n      font-size: 48px;\r\n      //line-height: 100px;\r\n    }\r\n\r\n    .upload-icon-i {\r\n      display: inline-block;\r\n    }\r\n  }\r\n\r\n  .content-list {\r\n    min-height: 300px;\r\n    border-radius: 20px;\r\n    //background: #f5f5f5;\r\n    margin-bottom: 30px;\r\n    margin-top: 30px;\r\n  }\r\n\r\n  .el-upload, .el-upload-dragger {\r\n    width: 100%;\r\n    height: 100%;\r\n    //border: 3px solid #222326;\r\n  }\r\n\r\n  .el-upload-dragger {\r\n    border-radius: 20px;\r\n    border: 3px dashed #d9d9d9;\r\n  }\r\n\r\n  .el-upload-dragger .el-icon-upload {\r\n    margin: 0;\r\n  }\r\n}\r\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}