{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nconst common_1 = require(\"../common\");\nasync function deepHash(data) {\n  if (Array.isArray(data)) {\n    const tag = common_1.default.utils.concatBuffers([common_1.default.utils.stringToBuffer(\"list\"), common_1.default.utils.stringToBuffer(data.length.toString())]);\n    return await deepHashChunks(data, await common_1.default.crypto.hash(tag, \"SHA-384\"));\n  }\n  const tag = common_1.default.utils.concatBuffers([common_1.default.utils.stringToBuffer(\"blob\"), common_1.default.utils.stringToBuffer(data.byteLength.toString())]);\n  const taggedHash = common_1.default.utils.concatBuffers([await common_1.default.crypto.hash(tag, \"SHA-384\"), await common_1.default.crypto.hash(data, \"SHA-384\")]);\n  return await common_1.default.crypto.hash(taggedHash, \"SHA-384\");\n}\nexports.default = deepHash;\nasync function deepHashChunks(chunks, acc) {\n  if (chunks.length < 1) {\n    return acc;\n  }\n  const hashPair = common_1.default.utils.concatBuffers([acc, await deepHash(chunks[0])]);\n  const newAcc = await common_1.default.crypto.hash(hashPair, \"SHA-384\");\n  return await deepHashChunks(chunks.slice(1), newAcc);\n}","map":{"version":3,"names":["common_1","require","deepHash","data","Array","isArray","tag","default","utils","concatBuffers","stringToBuffer","length","toString","deepHashChunks","crypto","hash","byteLength","taggedHash","exports","chunks","acc","hashPair","newAcc","slice"],"sources":["../../../../src/common/lib/deepHash.ts"],"sourcesContent":[null],"mappings":";;;;;AAAA,MAAAA,QAAA,GAAAC,OAAA;AAOe,eAAeC,QAAQA,CACpCC,IAAmB;EAEnB,IAAIC,KAAK,CAACC,OAAO,CAACF,IAAI,CAAC,EAAE;IACvB,MAAMG,GAAG,GAAGN,QAAA,CAAAO,OAAO,CAACC,KAAK,CAACC,aAAa,CAAC,CACtCT,QAAA,CAAAO,OAAO,CAACC,KAAK,CAACE,cAAc,CAAC,MAAM,CAAC,EACpCV,QAAA,CAAAO,OAAO,CAACC,KAAK,CAACE,cAAc,CAACP,IAAI,CAACQ,MAAM,CAACC,QAAQ,EAAE,CAAC,CACrD,CAAC;IAEF,OAAO,MAAMC,cAAc,CACzBV,IAAI,EACJ,MAAMH,QAAA,CAAAO,OAAO,CAACO,MAAM,CAACC,IAAI,CAACT,GAAG,EAAE,SAAS,CAAC,CAC1C;;EAGH,MAAMA,GAAG,GAAGN,QAAA,CAAAO,OAAO,CAACC,KAAK,CAACC,aAAa,CAAC,CACtCT,QAAA,CAAAO,OAAO,CAACC,KAAK,CAACE,cAAc,CAAC,MAAM,CAAC,EACpCV,QAAA,CAAAO,OAAO,CAACC,KAAK,CAACE,cAAc,CAACP,IAAI,CAACa,UAAU,CAACJ,QAAQ,EAAE,CAAC,CACzD,CAAC;EAEF,MAAMK,UAAU,GAAGjB,QAAA,CAAAO,OAAO,CAACC,KAAK,CAACC,aAAa,CAAC,CAC7C,MAAMT,QAAA,CAAAO,OAAO,CAACO,MAAM,CAACC,IAAI,CAACT,GAAG,EAAE,SAAS,CAAC,EACzC,MAAMN,QAAA,CAAAO,OAAO,CAACO,MAAM,CAACC,IAAI,CAACZ,IAAI,EAAE,SAAS,CAAC,CAC3C,CAAC;EAEF,OAAO,MAAMH,QAAA,CAAAO,OAAO,CAACO,MAAM,CAACC,IAAI,CAACE,UAAU,EAAE,SAAS,CAAC;AACzD;AA1BAC,OAAA,CAAAX,OAAA,GAAAL,QAAA;AA4BA,eAAeW,cAAcA,CAC3BM,MAAsB,EACtBC,GAAe;EAEf,IAAID,MAAM,CAACR,MAAM,GAAG,CAAC,EAAE;IACrB,OAAOS,GAAG;;EAGZ,MAAMC,QAAQ,GAAGrB,QAAA,CAAAO,OAAO,CAACC,KAAK,CAACC,aAAa,CAAC,CAC3CW,GAAG,EACH,MAAMlB,QAAQ,CAACiB,MAAM,CAAC,CAAC,CAAC,CAAC,CAC1B,CAAC;EACF,MAAMG,MAAM,GAAG,MAAMtB,QAAA,CAAAO,OAAO,CAACO,MAAM,CAACC,IAAI,CAACM,QAAQ,EAAE,SAAS,CAAC;EAC7D,OAAO,MAAMR,cAAc,CAACM,MAAM,CAACI,KAAK,CAAC,CAAC,CAAC,EAAED,MAAM,CAAC;AACtD"},"metadata":{},"sourceType":"script","externalDependencies":[]}