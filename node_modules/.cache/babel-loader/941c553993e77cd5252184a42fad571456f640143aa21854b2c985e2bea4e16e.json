{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nconst axios_1 = require(\"axios\");\nclass Api {\n  constructor(config) {\n    this.METHOD_GET = \"GET\";\n    this.METHOD_POST = \"POST\";\n    this.applyConfig(config);\n  }\n  applyConfig(config) {\n    this.config = this.mergeDefaults(config);\n  }\n  getConfig() {\n    return this.config;\n  }\n  mergeDefaults(config) {\n    const protocol = config.protocol || \"http\";\n    const port = config.port || (protocol === \"https\" ? 443 : 80);\n    return {\n      host: config.host || \"127.0.0.1\",\n      protocol,\n      port,\n      timeout: config.timeout || 20000,\n      logging: config.logging || false,\n      logger: config.logger || console.log,\n      network: config.network\n    };\n  }\n  async get(endpoint, config) {\n    try {\n      return await this.request().get(endpoint, config);\n    } catch (error) {\n      if (error.response && error.response.status) {\n        return error.response;\n      }\n      throw error;\n    }\n  }\n  async post(endpoint, body, config) {\n    try {\n      return await this.request().post(endpoint, body, config);\n    } catch (error) {\n      if (error.response && error.response.status) {\n        return error.response;\n      }\n      throw error;\n    }\n  }\n  /**\n   * Get an AxiosInstance with the base configuration setup to fire off\n   * a request to the network.\n   */\n  request() {\n    const headers = {};\n    if (this.config.network) {\n      headers[\"x-network\"] = this.config.network;\n    }\n    let instance = axios_1.default.create({\n      baseURL: `${this.config.protocol}://${this.config.host}:${this.config.port}`,\n      timeout: this.config.timeout,\n      maxContentLength: 1024 * 1024 * 512,\n      headers\n    });\n    if (this.config.logging) {\n      instance.interceptors.request.use(request => {\n        this.config.logger(`Requesting: ${request.baseURL}/${request.url}`);\n        return request;\n      });\n      instance.interceptors.response.use(response => {\n        this.config.logger(`Response:   ${response.config.url} - ${response.status}`);\n        return response;\n      });\n    }\n    return instance;\n  }\n}\nexports.default = Api;","map":{"version":3,"names":["axios_1","require","Api","constructor","config","METHOD_GET","METHOD_POST","applyConfig","mergeDefaults","getConfig","protocol","port","host","timeout","logging","logger","console","log","network","get","endpoint","request","error","response","status","post","body","headers","instance","default","create","baseURL","maxContentLength","interceptors","use","url","exports"],"sources":["../../../../src/common/lib/api.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}