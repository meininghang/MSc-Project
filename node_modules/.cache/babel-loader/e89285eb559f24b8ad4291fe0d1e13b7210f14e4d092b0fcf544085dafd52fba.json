{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/es.typed-array.to-reversed.js\");\nrequire(\"core-js/modules/es.typed-array.to-sorted.js\");\nrequire(\"core-js/modules/es.typed-array.with.js\");\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nconst base64url_1 = __importDefault(require(\"base64url\"));\nconst ed25519_1 = require(\"@noble/ed25519\");\nconst constants_1 = require(\"../../constants\");\nclass Curve25519 {\n  constructor(_key, pk) {\n    this._key = _key;\n    this.pk = pk;\n    this.ownerLength = constants_1.SIG_CONFIG[2].pubLength;\n    this.signatureLength = constants_1.SIG_CONFIG[2].sigLength;\n    this.signatureType = 2;\n  }\n  get publicKey() {\n    return this._publicKey;\n  }\n  get key() {\n    return new Uint8Array(0);\n  }\n  sign(message) {\n    return ed25519_1.sign(Buffer.from(message), Buffer.from(this.key));\n  }\n  static async verify(pk, message, signature) {\n    let p = pk;\n    if (typeof pk === \"string\") p = base64url_1.default.toBuffer(pk);\n    return ed25519_1.verify(Buffer.from(signature), Buffer.from(message), Buffer.from(p));\n  }\n}\nexports.default = Curve25519;","map":{"version":3,"names":["base64url_1","__importDefault","require","ed25519_1","constants_1","Curve25519","constructor","_key","pk","ownerLength","SIG_CONFIG","pubLength","signatureLength","sigLength","signatureType","publicKey","_publicKey","key","Uint8Array","sign","message","Buffer","from","verify","signature","p","default","toBuffer","exports"],"sources":["curve25519.ts"],"sourcesContent":[null],"mappings":";;;;;;;;;;;;;AACA,MAAAA,WAAA,GAAAC,eAAA,CAAAC,OAAA;AACA,MAAAC,SAAA,GAAAD,OAAA;AACA,MAAAE,WAAA,GAAAF,OAAA;AAEA,MAAqBG,UAAU;EAS7BC,YAAsBC,IAAY,EAASC,EAAU;IAA/B,KAAAD,IAAI,GAAJA,IAAI;IAAiB,KAAAC,EAAE,GAAFA,EAAE;IARpC,KAAAC,WAAW,GAAWL,WAAA,CAAAM,UAAU,CAAC,CAAC,CAAC,CAACC,SAAS;IAC7C,KAAAC,eAAe,GAAWR,WAAA,CAAAM,UAAU,CAAC,CAAC,CAAC,CAACG,SAAS;IAKjD,KAAAC,aAAa,GAAW,CAAC;EAGlC;EANA,IAAWC,SAASA,CAAA;IACd,OAAO,IAAI,CAACC,UAAU;EAC1B;EAMF,IAAWC,GAAGA,CAAA;IACZ,OAAO,IAAIC,UAAU,CAAC,CAAC,CAAC;EAC1B;EAEAC,IAAIA,CAACC,OAAmB;IACtB,OAAOjB,SAAA,CAAAgB,IAAI,CAACE,MAAM,CAACC,IAAI,CAACF,OAAO,CAAC,EAAEC,MAAM,CAACC,IAAI,CAAC,IAAI,CAACL,GAAG,CAAC,CAAC;EAC1D;EAEA,aAAaM,MAAMA,CACjBf,EAAmB,EACnBY,OAAmB,EACnBI,SAAqB;IAErB,IAAIC,CAAC,GAAGjB,EAAE;IACV,IAAI,OAAOA,EAAE,KAAK,QAAQ,EAAEiB,CAAC,GAAGzB,WAAA,CAAA0B,OAAS,CAACC,QAAQ,CAACnB,EAAE,CAAC;IACtD,OAAOL,SAAA,CAAAoB,MAAM,CAACF,MAAM,CAACC,IAAI,CAACE,SAAS,CAAC,EAAEH,MAAM,CAACC,IAAI,CAACF,OAAO,CAAC,EAAEC,MAAM,CAACC,IAAI,CAACG,CAAC,CAAC,CAAC;EAC7E;;AA5BFG,OAAA,CAAAF,OAAA,GAAArB,UAAA"},"metadata":{},"sourceType":"script","externalDependencies":[]}